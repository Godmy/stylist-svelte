# План реализации компонентов GraphQL-визуализатора для Svelte 5 Runes

## 1. Понимание целевой функциональности

GraphQL-визуализатор создает ERD-подобные (диаграммы взаимосвязей сущностей) визуализации из интроспекции GraphQL. Он позволяет пользователям:

- Вводить URL-адрес GraphQL-эндпоинта
- Выполнять запросы интроспекции
- Визуализировать структуру схемы с соединениями между типами
- Отображать отношения между GraphQL-типами

## 2. Архитектура компонентов по методологии Atomic Design

Я организую компоненты визуализации по методологии Atomic Design с 4 уровнями:

### Атомы (Базовые строительные блоки)

- **Canvas**: Базовый элемент холста для визуализации
- **GraphNode**: Отдельный узел, представляющий GraphQL-тип
- **GraphEdge**: Линия/соединение, представляющее отношения между типами
- **Label**: Текст для узлов и соединений
- **Icon**: Иконки для разных типов (скалярный, объект, перечисление и т.д.)
- **Tooltip**: Всплывающие подсказки для узлов
- **Spinner**: Индикатор загрузки
- **Button**: Кнопки действий (обновить, сохранить и т.д.)
- **Input**: Поле ввода для GraphQL-эндпоинта
- **Checkbox**: Параметры визуализации
- **Select**: Выпадающие списки для выбора типов

### Молекулы (Простые составные компоненты)

- **GraphNodeCard**: Узел с подробностями, свойствами и отношениями
- **LegendItem**: Отдельный элемент легенды с цветовой кодировкой
- **SearchBar**: Функциональность поиска для нахождения типов
- **FilterPanel**: Панель фильтров для типов, полей и т.д.
- **Toolbar**: Коллекция кнопок действий
- **EndpointInput**: Поле ввода с проверкой для GraphQL-эндпоинта
- **ZoomControls**: Элементы управления масштабом для графа

### Организмы (Комплексные составные компоненты)

- **VisualizationCanvas**: Основная область холста с узлами и соединениями
- **LegendPanel**: Полная легенда со всеми индикаторами типов
- **ControlPanel**: Панель с фильтрами, поиском и параметрами
- **GraphNodeDetails**: Подробное представление выбранного узла
- **SchemaExplorer**: Древовидное представление структуры схемы
- **ExportPanel**: Панель для экспорта визуализаций (PNG, SVG и т.д.)
- **GraphNodeModal**: Модальное окно для просмотра подробной информации об узле

### Компоненты обратной связи

- **LoadingOverlay**: Полнэкранное указание загрузки
- **ErrorMessage**: Отображение ошибок для неудавшихся интроспекций
- **SuccessMessage**: Подтверждение успеха
- **InfoPanel**: Информация о визуализации

## 3. Реализация с использованием Svelte 5 Runes

Все компоненты будут использовать Svelte 5 runes для управления состоянием:

- `$state()` для локального состояния компонентов
- `$derived()` для вычисляемых значений
- `$effect()` для побочных эффектов и реактивности
- `$props()` для свойств компонентов

## 4. Фазы реализации

### Фаза 1: Базовые атомы визуализации

1. Создать компонент `Canvas.svelte` с надлежащим viewBox и функциональностью панорамирования/масштабирования
2. Создать `GraphNode.svelte` для представления отдельных GraphQL-типов
3. Создать `GraphEdge.svelte` для отношений между типами
4. Создать вспомогательные атомы: `Label`, `Icon`, `Tooltip` и т.д.

### Фаза 2: Молекулы визуализации

1. Создать `GraphNodeCard.svelte`, объединяющий узлы с дополнительными сведениями
2. Создать `LegendItem.svelte` для индикаторов типов
3. Создать `SearchBar.svelte` для поиска конкретных типов
4. Создать `FilterPanel.svelte` для параметров визуализации
5. Создать `Toolbar.svelte` с кнопками масштабирования и экспорта

### Фаза 3: Основные организмы

1. Создать `VisualizationCanvas.svelte`, координирующий визуализацию
2. Создать `LegendPanel.svelte`, отображающий все индикаторы типов
3. Создать `ControlPanel.svelte` для фильтров и параметров
4. Создать `GraphNodeDetails.svelte` для отображения информации об узле

### Фаза 4: Расширенные возможности

1. Реализовать функциональность интроспекции схемы
2. Создать `SchemaExplorer.svelte` для просмотра схемы
3. Реализовать функцию экспорта (PNG, SVG и т.д.)
4. Добавить поддержку клавиатурной навигации
5. Добавить функции доступности

## 5. Ключевые технические соображения

### Управление состоянием с помощью Runes

- Использовать `$state()` для управления текущим состоянием визуализации
- Использовать `$derived()` для расчета позиций узлов и отношений
- Использовать `$effect()` для обработки рендеринга холста и обновления графа

### Обработка схемы GraphQL

- Реализовать функции для парсинга результатов интроспекции GraphQL
- Создать структуры данных для представления схемы для визуализации
- Обработать различные GraphQL-типы (объекты, перечисления, скаляры, объединения и т.д.)

### Визуальный дизайн

- Следовать реализации Tailwind CSS в соответствии с ADR 0002
- Обеспечить адаптивный дизайн для разных размеров экрана
- Создать согласованную цветовую схему для различных типов

### Оптимизация производительности

- Реализовать виртуализацию для больших схем
- Использовать эффективные методы рендеринга для холста/графа
- Оптимизировать с помощью runes для минимальных повторных рендеров
