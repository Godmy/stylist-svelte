# Общий план нормализации дизайн-системы для всех потоков

## Введение

На основе анализа, проведенного потоками 1 и 2, выявлены системные проблемы в архитектуре дизайн-системы, которые требуют комплексного подхода для решения. Данный план охватывает все 9 потоков и предусматривает поэтапное внедрение нормализации.

## Выявленные системные проблемы

### 1. Нарушение принципа единственной ответственности
- Файлы моделей содержат функции для нескольких компонентов (например, `container.svelte.ts`)
- Это затрудняет поддержку, тестирование и понимание кода

### 2. Несогласованность в типизации
- Используются разные подходы к определению типов размеров
- Некоторые компоненты используют слишком общие типы (например, `string | number`)
- Отсутствует стандартизация для часто используемых пропсов

### 3. Непоследовательное использование токенов
- Некоторые компоненты используют общие токены, другие определяют свои собственные
- Отсутствует единая система управления токенами

### 4. Дублирование логики
- Одинаковая структура функций в разных файлах
- Копирование-вставка кода приводит к ошибкам и несогласованности

## План нормализации по потокам

### Потоки 1-3: Атомарные компоненты
**Фокус:** Завершение миграции на Story.svelte и начальная нормализация

#### Поток 1: Architecture Atoms
- [x] Завершен анализ (см. task_thread_10_architecture_normalization_report.md)
- [ ] Внедрение декомпозиции файлов моделей
- [ ] Стандартизация типов размеров
- [ ] Обновление всех компонентов согласно плану нормализации

#### Поток 2: Information Atoms
- [ ] Завершение миграции Story-файлов на общий компонент Story.svelte
- [ ] Нормализация структуры дизайн-системы
- [ ] Стандартизация типов и токенов

#### Поток 3: Interaction Atoms
- [x] Анализ текущего состояния компонентов
- [x] Миграция на общий компонент Story.svelte
- [x] Нормализация файлов моделей

### Потоки 4-6: Молекулярные компоненты
**Фокус:** Продолжение нормализации и внедрение улучшений

#### Поток 4: Architecture Molecules
- [ ] Анализ текущего состояния компонентов
- [ ] Миграция на общий компонент Story.svelte
- [ ] Нормализация файлов моделей
- [ ] Стандартизация типов и токенов

#### Поток 5: Information Molecules
- [ ] Анализ текущего состояния компонентов
- [ ] Миграция на общий компонент Story.svelte
- [ ] Нормализация файлов моделей
- [ ] Стандартизация типов и токенов

#### Поток 6: Interaction Molecules
- [x] Анализ текущего состояния компонентов
- [x] Миграция на общий компонент Story.svelte
- [ ] Нормализация файлов моделей
- [ ] Стандартизация типов и токенов

### Потоки 7-9: Организменные компоненты
**Фокус:** Завершение нормализации и внедрение улучшений

#### Поток 7: Architecture Organisms
- [ ] Анализ текущего состояния компонентов
- [ ] Миграция на общий компонент Story.svelte
- [ ] Нормализация файлов моделей
- [ ] Стандартизация типов и токенов

#### Поток 8: Information Organisms
- [ ] Анализ текущего состояния компонентов
- [ ] Миграция на общий компонент Story.svelte
- [ ] Нормализация файлов моделей
- [ ] Стандартизация типов и токенов

#### Поток 9: Interaction Organisms
- [ ] Анализ текущего состояния компонентов
- [ ] Миграция на общий компонент Story.svelte
- [ ] Нормализация файлов моделей
- [ ] Стандартизация типов и токенов

## Этапы внедрения нормализации

### Этап 1: Подготовительный (Потоки 1-3)
**Цель:** Завершение миграции Story-файлов и начальная нормализация

**Действия:**
- [x] Завершить миграцию всех компонентов на общий компонент Story.svelte
- [ ] Создать шаблоны для новых компонентов
- [ ] Обновить документацию по стандартам

**Метрики успеха:**
- Все story-файлы используют общий компонент Story.svelte
- Унифицированная структура контролов
- Унифицированные типы для часто используемых пропсов

### Этап 2: Декомпозиция (Потоки 4-6)
**Цель:** Разделение файлов моделей и стандартизация типов

**Действия:**
- [ ] Разделить файлы моделей с несколькими функциями на отдельные файлы
- [ ] Создать унифицированные типы для размеров и других пропсов
- [ ] Обновить все компоненты для использования новых типов

**Метрики успеха:**
- Каждый компонент имеет свой собственный файл модели
- Последовательное использование унифицированных типов
- Устранение дублирования логики

### Этап 3: Оптимизация (Потоки 7-9)
**Цель:** Улучшение производительности и пользовательского опыта

**Действия:**
- [ ] Оптимизация импортов и уменьшение размера бандла
- [ ] Улучшение типизации для повышения безопасности
- [ ] Внедрение автоматизированного тестирования

**Метрики успеха:**
- Уменьшение размера бандла
- Повышенная безопасность типов
- Улучшенная производительность компонентов

## Рекомендации по внедрению

### Безопасное внедрение
1. Создать отдельную ветку для нормализации
2. Внедрять изменения постепенно, компонент за компонентом
3. Проводить тестирование после каждого этапа
4. Обеспечить обратную совместимость при возможных изменениях API

### Контроль качества
1. Проводить код-ревью изменений
2. Обновить тесты для новых структур
3. Проверить сборку проекта после изменений
4. Провести ручное тестирование компонентов

## Золотой стандарт компонентов

### Архитектурные требования
1. Каждый компонент должен иметь отдельный файл модели
2. Все компоненты должны использовать унифицированные типы
3. Все story-файлы должны использовать общий компонент Story.svelte
4. Соблюдение принципа единственной ответственности

### Технические требования
1. Строгая типизация для всех пропсов
2. Последовательное использование токенов
3. Унифицированная структура файлов дизайн-системы
4. Автоматизированное тестирование соблюдения стандартов

## Заключение

Данный план обеспечивает системный подход к нормализации дизайн-системы для всех 9 потоков. Внедрение изменений поэтапно позволит минимизировать риски и обеспечить стабильность системы. Успешная реализация плана заложит прочный фундамент для будущего развития дизайн-системы.